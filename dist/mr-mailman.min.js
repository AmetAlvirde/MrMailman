"use strict";var fs=require("fs"),mailer,mailover=require("mailover"),R=require("ramda"),ReadWriteLock=require("rwlock");module.exports=function(a){var b={auth:{}},c=new ReadWriteLock,d={};b.service=a.auth.service,b.auth.user=a.auth.user,b.auth.mail=a.auth.mail,c.writeLock(function(c){fs.readFile(a.content.templateURL,"utf-8",function(e,f){if(e)throw e;var g;R.forEach(function(a){g=R.keys(a)[0],f=f.replace("/".concat(g,"/g"),a[g])},a.content.replaces),R.forEach(function(c){d.from=a.from,d.to=c.mail,d.subject=a.subject,d.markdown=f,mailer=mailover(b),mailer.send(d)},a.receivers),c()})})};